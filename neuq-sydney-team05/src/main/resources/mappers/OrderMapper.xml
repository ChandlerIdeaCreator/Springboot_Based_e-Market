<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.school_mall.repository.OrderMapper">
  
  <resultMap id="BaseResultMap" type="com.school_mall.entity.Order">
    <id column="id" property="id" jdbcType="BIGINT"/>
    <result column="order_no" property="orderNo" jdbcType="VARCHAR"/>
    <result column="user_id" property="userId" jdbcType="BIGINT"/>
    <result column="order_status" property="orderStatus" jdbcType="TINYINT"/>
    <result column="total_amount" property="totalAmount" jdbcType="DECIMAL"/>
    <result column="receiver" property="receiver" jdbcType="VARCHAR"/>
    <result column="receiver_phone" property="receiverPhone" jdbcType="VARCHAR"/>
    <result column="region" property="region" jdbcType="VARCHAR"/>
    <result column="detail_address" property="detailAddress" jdbcType="VARCHAR"/>
    <result column="pay_time" property="payTime" jdbcType="TIMESTAMP"/>
    <result column="create_time" property="createTime" jdbcType="TIMESTAMP"/>
    <result column="update_time" property="updateTime" jdbcType="TIMESTAMP"/>
  </resultMap>
  
  <sql id="Base_Column_List">
    id, order_no, user_id, order_status, total_amount, receiver, receiver_phone,
    region, detail_address, pay_time, create_time, update_time
  </sql>
  
  <select id="selectById" parameterType="long" resultMap="BaseResultMap">
    SELECT <include refid="Base_Column_List"/>
    FROM `order`
    WHERE id = #{id}
  </select>

  <select id="selectAll" resultMap="BaseResultMap">
    SELECT <include refid="Base_Column_List"/>
    FROM `order`
  </select>

  <select id="selectByOrderNo" parameterType="string" resultMap="BaseResultMap">
    SELECT <include refid="Base_Column_List"/>
    FROM `order`
    WHERE order_no = #{orderNo}
  </select>

  <select id="selectByUserId" parameterType="long" resultMap="BaseResultMap">
    SELECT <include refid="Base_Column_List"/>
    FROM `order`
    WHERE user_id = #{userId}
  </select>

  <select id="selectByUserPaged" resultMap="BaseResultMap">
    SELECT <include refid="Base_Column_List"/>
    FROM `order`
    WHERE user_id = #{userId}
    ORDER BY ${sortColumn} ${sortOrder}
    LIMIT #{limit} OFFSET #{offset}
  </select>

  <insert id="insert" parameterType="com.school_mall.entity.Order" useGeneratedKeys="true" keyProperty="id">
    INSERT INTO `order` (
      order_no, user_id, order_status, total_amount, receiver, receiver_phone,
      region, detail_address, pay_time, create_time, update_time
    )
    VALUES (
      #{orderNo}, #{userId}, #{orderStatus}, #{totalAmount}, #{receiver}, #{receiverPhone},
      #{region}, #{detailAddress}, #{payTime}, #{createTime}, #{updateTime}
    )
  </insert>

  <insert id="insertSelective" parameterType="com.school_mall.entity.Order" useGeneratedKeys="true" keyProperty="id">
    INSERT INTO `order`
    <trim prefix="(" suffix=")" suffixOverrides=",">
      <if test="orderNo != null">order_no,</if>
      <if test="userId != null">user_id,</if>
      <if test="orderStatus != null">order_status,</if>
      <if test="totalAmount != null">total_amount,</if>
      <if test="receiver != null">receiver,</if>
      <if test="receiverPhone != null">receiver_phone,</if>
      <if test="region != null">region,</if>
      <if test="detailAddress != null">detail_address,</if>
      <if test="payTime != null">pay_time,</if>
      <if test="createTime != null">create_time,</if>
      <if test="updateTime != null">update_time,</if>
    </trim>
    <trim prefix="VALUES (" suffix=")" suffixOverrides=",">
      <if test="orderNo != null">#{orderNo},</if>
      <if test="userId != null">#{userId},</if>
      <if test="orderStatus != null">#{orderStatus},</if>
      <if test="totalAmount != null">#{totalAmount},</if>
      <if test="receiver != null">#{receiver},</if>
      <if test="receiverPhone != null">#{receiverPhone},</if>
      <if test="region != null">#{region},</if>
      <if test="detailAddress != null">#{detailAddress},</if>
      <if test="payTime != null">#{payTime},</if>
      <if test="createTime != null">#{createTime},</if>
      <if test="updateTime != null">#{updateTime},</if>
    </trim>
  </insert>

  <update id="updateById" parameterType="com.school_mall.entity.Order">
    UPDATE `order`
    SET order_no = #{orderNo}, user_id = #{userId}, order_status = #{orderStatus},
        total_amount = #{totalAmount}, receiver = #{receiver}, receiver_phone = #{receiverPhone},
        region = #{region}, detail_address = #{detailAddress}, pay_time = #{payTime},
        create_time = #{createTime}, update_time = #{updateTime}
    WHERE id = #{id}
  </update>

  <update id="updateByIdSelective" parameterType="com.school_mall.entity.Order">
    UPDATE `order`
    <set>
      <if test="orderNo != null">order_no = #{orderNo},</if>
      <if test="userId != null">user_id = #{userId},</if>
      <if test="orderStatus != null">order_status = #{orderStatus},</if>
      <if test="totalAmount != null">total_amount = #{totalAmount},</if>
      <if test="receiver != null">receiver = #{receiver},</if>
      <if test="receiverPhone != null">receiver_phone = #{receiverPhone},</if>
      <if test="region != null">region = #{region},</if>
      <if test="detailAddress != null">detail_address = #{detailAddress},</if>
      <if test="payTime != null">pay_time = #{payTime},</if>
      <if test="createTime != null">create_time = #{createTime},</if>
      <if test="updateTime != null">update_time = #{updateTime},</if>
    </set>
    WHERE id = #{id}
  </update>

  <delete id="deleteById" parameterType="long">
    DELETE FROM `order` WHERE id = #{id}
  </delete>

</mapper>
